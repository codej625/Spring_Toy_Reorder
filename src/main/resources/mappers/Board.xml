<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">

	<select id="select" resultType="BoardRequest">
		SELECT A.no
		       , title
		       , contents
		       , count(B.no) AS reorder
		FROM   board A LEFT JOIN comment B
		ON     A.no = B.no
		GROUP  BY A.no
		ORDER  BY A.no
	</select>

	<insert id="insert" parameterType="BoardRequest">
		INSERT INTO board
		VALUES (
			NEXTVAL('board_seq')
			, #{title}
			, #{contents}
			)
	</insert>
	
	<select id="content" parameterType="BoardRequest" resultType="BoardRequest">
		SELECT *
		FROM   board
		WHERE  no = #{no}
	</select>
	
	<select id="reorder" parameterType="int" resultType="Integer">
			SELECT COUNT(*)
			FROM   board A, comment B
			WHERE  A.no = B.no
			AND    B.reorder = 0
			AND    A.no = #{reorderNum}
	</select>
	
</mapper>